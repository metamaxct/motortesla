<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Motor Eléctrico Tipo Tesla (IPM)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cyan: #00ffc8;
            --cyan-dark: #00a8ff;
            --green: #22c55e;
            --orange: #f97316;
            --red: #ef4444;
            --purple: #a855f7;
            --yellow: #eab308;
            --bg-dark: #0a0a0f;
            --bg-card: rgba(20, 20, 30, 0.8);
            --border: #2a2a3a;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0f0f1a 100%);
            color: #e5e5e5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1500px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--bg-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .logo-icon.active {
            box-shadow: 0 0 30px rgba(0, 255, 200, 0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 200, 0.5); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 200, 0.8); }
        }

        .logo-icon svg {
            width: 28px;
            height: 28px;
            stroke: #666;
            transition: stroke 0.3s ease;
        }

        .logo-icon.active svg {
            stroke: var(--cyan);
        }

        .logo-text h1 {
            font-size: 1.5rem;
            background: linear-gradient(90deg, var(--cyan), var(--cyan-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.85rem;
            color: #666;
        }

        .power-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .power-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: var(--bg-card);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border: 2px solid var(--border);
        }

        .power-btn:hover {
            background: rgba(40, 40, 60, 0.8);
        }

        .power-btn.active {
            background: var(--green);
            border-color: var(--green);
            box-shadow: 0 0 25px rgba(34, 197, 94, 0.5);
        }

        .power-btn svg {
            width: 28px;
            height: 28px;
            stroke: #666;
            transition: stroke 0.3s ease;
        }

        .power-btn.active svg {
            stroke: white;
        }

        .status {
            text-align: right;
        }

        .status-label {
            font-size: 0.75rem;
            color: #666;
        }

        .status-value {
            font-size: 1rem;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .status-value.on {
            color: var(--green);
            animation: blink 1s infinite;
        }

        .status-value.off {
            color: var(--red);
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--cyan);
            font-size: 1rem;
        }

        .card-title svg {
            width: 20px;
            height: 20px;
        }

        /* Motor Visualization */
        .motor-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            max-height: 400px;
        }

        .motor-svg {
            width: 100%;
            height: 100%;
            transition: filter 0.3s ease;
        }

        .motor-svg.active {
            filter: drop-shadow(0 0 20px rgba(0, 255, 200, 0.3));
        }

        .motor-specs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 15px;
        }

        .spec-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 10px;
            border-radius: 8px;
            font-size: 0.75rem;
        }

        .spec-label {
            color: #666;
        }

        .spec-value {
            color: var(--cyan);
            margin-left: 5px;
        }

        /* Component Comments */
        .component-legend {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }

        .legend-title {
            font-size: 0.9rem;
            color: var(--cyan);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .legend-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 3px solid;
        }

        .legend-item.copper { border-color: #b87333; }
        .legend-item.stator { border-color: #4a4a6a; }
        .legend-item.rotor { border-color: var(--cyan); }
        .legend-item.magnet-n { border-color: #ff4444; }
        .legend-item.magnet-s { border-color: #4444ff; }
        .legend-item.airgap { border-color: #888; }
        .legend-item.shaft { border-color: #666; }
        .legend-item.field { border-color: rgba(0, 255, 200, 0.5); }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .legend-text h5 {
            font-size: 0.8rem;
            color: #ddd;
            margin-bottom: 3px;
        }

        .legend-text p {
            font-size: 0.7rem;
            color: #888;
            line-height: 1.4;
        }

        /* Rotor Animation */
        .rotor-group {
            transform-origin: 200px 200px;
            transition: transform 0.1s linear;
        }

        .rotor-group.spinning {
            animation: spin var(--spin-duration, 2s) linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Field Lines Animation */
        .field-line {
            stroke-dasharray: 10, 5;
            animation: fieldFlow 1s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .field-line.active {
            opacity: 0.6;
        }

        @keyframes fieldFlow {
            from { stroke-dashoffset: 0; }
            to { stroke-dashoffset: -30; }
        }

        /* Controls */
        .control-section {
            margin-bottom: 20px;
        }

        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .control-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .control-label svg {
            width: 16px;
            height: 16px;
        }

        .control-value {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .control-comment {
            font-size: 0.75rem;
            color: #888;
            margin-top: 8px;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            border-left: 3px solid var(--cyan);
        }

        /* Voltage Slider */
        .voltage-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(90deg, #2a2a3a 0%, #2a2a3a 100%);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }

        .voltage-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--cyan), var(--cyan-dark));
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 255, 200, 0.5);
            transition: transform 0.2s ease;
        }

        .voltage-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #666;
            margin-top: 5px;
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            gap: 10px;
        }

        .mode-btn {
            flex: 1;
            padding: 12px 8px;
            border: 2px solid var(--border);
            background: transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #666;
        }

        .mode-btn:hover {
            border-color: #555;
        }

        .mode-btn.active.eco {
            border-color: var(--green);
            color: var(--green);
            background: rgba(34, 197, 94, 0.1);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        .mode-btn.active.normal {
            border-color: #3b82f6;
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        .mode-btn.active.sport {
            border-color: var(--red);
            color: var(--red);
            background: rgba(239, 68, 68, 0.1);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        .mode-btn svg {
            width: 20px;
            height: 20px;
        }

        .mode-btn span {
            font-size: 0.75rem;
        }

        /* Throttle */
        .throttle-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
        }

        .throttle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .throttle-label {
            font-size: 0.8rem;
            color: #888;
        }

        .throttle-pedal {
            width: 70px;
            height: 140px;
            background: linear-gradient(180deg, #2a2a3a 0%, #1a1a2e 100%);
            border-radius: 10px;
            border: 2px solid var(--border);
            position: relative;
            cursor: pointer;
            overflow: hidden;
            user-select: none;
        }

        .throttle-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(0deg, var(--cyan) 0%, rgba(0, 255, 200, 0.3) 100%);
            transition: height 0.1s ease;
            box-shadow: 0 0 20px rgba(0, 255, 200, 0.5);
        }

        .throttle-pedal::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50px;
            border-top: 2px solid #444;
        }

        .throttle-value {
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            color: var(--cyan);
        }

        .throttle-buttons {
            display: flex;
            gap: 8px;
        }

        .throttle-btn {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border);
            background: var(--bg-card);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: #888;
        }

        .throttle-btn:hover:not(:disabled) {
            background: #2a2a3a;
            color: var(--cyan);
        }

        .throttle-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .throttle-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Battery & Temp */
        .status-gauges {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .status-gauge {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .status-gauge svg {
            width: 30px;
            height: 30px;
        }

        .status-gauge .value {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .status-gauge .label {
            font-size: 0.75rem;
            color: #666;
        }

        .battery-low { color: var(--red); }
        .battery-medium { color: var(--yellow); }
        .battery-high { color: var(--green); }
        .temp-high { color: var(--red); }
        .temp-medium { color: var(--orange); }
        .temp-normal { color: var(--cyan); }

        /* Current Display */
        .current-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .current-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .current-value {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--orange);
        }

        .progress-bar {
            height: 6px;
            background: #1a1a2e;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--orange), var(--yellow));
            border-radius: 3px;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(249, 115, 22, 0.5);
        }

        /* Dashboard */
        .dashboard-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Circular Gauges */
        .gauge-row {
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
        }

        .circular-gauge {
            position: relative;
            width: 110px;
            height: 130px;
        }

        .circular-gauge svg {
            width: 100%;
            height: 100px;
            transform: rotate(-90deg);
        }

        .gauge-bg {
            fill: none;
            stroke: #1a1a2e;
            stroke-width: 8;
        }

        .gauge-fill {
            fill: none;
            stroke: url(#gaugeGradient);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
            filter: drop-shadow(0 0 6px rgba(0, 255, 200, 0.6));
        }

        .gauge-inner {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        .gauge-value {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--cyan);
        }

        .gauge-unit {
            font-size: 0.7rem;
            color: #666;
        }

        .gauge-label {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: #888;
            white-space: nowrap;
        }

        /* Linear Gauges */
        .linear-gauge {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 15px;
        }

        .linear-gauge-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .linear-gauge-header svg {
            width: 16px;
            height: 16px;
        }

        .linear-gauge-label {
            font-size: 0.8rem;
            color: #888;
        }

        .linear-gauge-value {
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .linear-gauge-number {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .linear-gauge-unit {
            font-size: 0.8rem;
            color: #666;
        }

        .linear-gauge-bar {
            height: 8px;
            background: #1a1a2e;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }

        .linear-gauge-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .linear-gauge-fill.cyan {
            background: linear-gradient(90deg, var(--cyan), var(--cyan-dark));
            box-shadow: 0 0 15px rgba(0, 255, 200, 0.4);
        }

        .linear-gauge-fill.orange {
            background: linear-gradient(90deg, var(--orange), var(--yellow));
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.4);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-card svg {
            width: 20px;
            height: 20px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.7rem;
            color: #666;
        }

        /* Info Panel */
        .info-panel {
            margin-top: 25px;
            display: none;
        }

        .info-panel.visible {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .info-section h4 {
            color: var(--cyan);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .info-section h4 svg {
            width: 16px;
            height: 16px;
        }

        .info-section p {
            font-size: 0.85rem;
            color: #aaa;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .info-section ul {
            list-style: none;
            font-size: 0.85rem;
            color: #888;
        }

        .info-section li {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
        }

        .info-section li::before {
            content: '•';
            color: var(--cyan);
            position: absolute;
            left: 0;
        }

        .info-section strong {
            color: #ddd;
        }

        .formula-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }

        .formula-box p {
            margin-bottom: 5px;
            color: #aaa;
        }

        .mode-comparison {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .mode-box {
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .mode-box.eco {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .mode-box.normal {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .mode-box.sport {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .mode-box strong {
            display: block;
            margin-bottom: 5px;
        }

        .mode-box p {
            font-size: 0.75rem;
            margin: 0;
        }

        .info-btn {
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            color: #888;
            transition: all 0.2s ease;
        }

        .info-btn:hover {
            background: var(--bg-card);
            color: var(--cyan);
        }

        .info-btn svg {
            width: 20px;
            height: 20px;
        }

        /* Tesla Tech Specs */
        .tesla-specs {
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.3), rgba(20, 20, 30, 0.5));
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 200, 0.2);
        }

        .tesla-specs h4 {
            color: var(--cyan);
            font-size: 0.9rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tesla-badge {
            display: inline-block;
            background: linear-gradient(90deg, #cc0000, #ff3333);
            color: white;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .tesla-info {
            font-size: 0.75rem;
            color: #aaa;
            line-height: 1.6;
        }

        .tesla-info p {
            margin-bottom: 8px;
        }

        .tesla-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .tesla-feature {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 6px;
            font-size: 0.7rem;
        }

        .tesla-feature strong {
            color: var(--cyan);
            display: block;
            margin-bottom: 2px;
        }

        /* Footer */
        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 0.75rem;
            color: #444;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }

            .power-controls {
                width: 100%;
                justify-content: space-between;
            }

            .throttle-section {
                flex-direction: column;
                gap: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .mode-comparison {
                grid-template-columns: 1fr;
            }

            .legend-grid {
                grid-template-columns: 1fr;
            }

            .tesla-features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon" id="logoIcon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>Simulador de Motor Eléctrico IPM</h1>
                    <p>Configuración tipo Tesla - Imanes Permanentes Interiores</p>
                </div>
            </div>
            <div class="power-controls">
                <button class="info-btn" id="infoBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                </button>
                <button class="power-btn" id="powerBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path>
                        <line x1="12" y1="2" x2="12" y2="12"></line>
                    </svg>
                </button>
                <div class="status">
                    <div class="status-label">Estado</div>
                    <div class="status-value off" id="statusValue">APAGADO</div>
                </div>
            </div>
        </header>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Motor Visualization -->
            <div class="card">
                <div class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Motor IPM (Interior Permanent Magnet) - Estilo Tesla
                </div>
                <div class="motor-container">
                    <svg class="motor-svg" id="motorSvg" viewBox="0 0 400 400">
                        <defs>
                            <!-- Rotor core gradient (laminated steel) -->
                            <radialGradient id="rotorGradient" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" stop-color="#2a3a4a" />
                                <stop offset="100%" stop-color="#1a2a3a" />
                            </radialGradient>
                            
                            <!-- Stator gradient -->
                            <linearGradient id="statorGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#3a3a5a" />
                                <stop offset="100%" stop-color="#2a2a4a" />
                            </linearGradient>
                            
                            <!-- Copper winding gradient -->
                            <linearGradient id="copperGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#b87333" />
                                <stop offset="50%" stop-color="#da8a47" />
                                <stop offset="100%" stop-color="#b87333" />
                            </linearGradient>
                            
                            <!-- North pole magnet (red) -->
                            <linearGradient id="magnetNorth" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#cc3333" />
                                <stop offset="50%" stop-color="#ff4444" />
                                <stop offset="100%" stop-color="#cc3333" />
                            </linearGradient>
                            
                            <!-- South pole magnet (blue) -->
                            <linearGradient id="magnetSouth" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#3333cc" />
                                <stop offset="50%" stop-color="#4444ff" />
                                <stop offset="100%" stop-color="#3333cc" />
                            </linearGradient>
                            
                            <!-- Gauge gradient -->
                            <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#00ffc8" />
                                <stop offset="100%" stop-color="#00a8ff" />
                            </linearGradient>
                            
                            <!-- Shaft gradient -->
                            <radialGradient id="shaftGradient" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" stop-color="#4a4a5a" />
                                <stop offset="100%" stop-color="#2a2a3a" />
                            </radialGradient>
                        </defs>
                        
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <!-- STATOR - Parte fija externa con bobinas de cobre            -->
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        
                        <!-- Outer casing (carcasa exterior) -->
                        <circle cx="200" cy="200" r="180" fill="url(#statorGradient)" stroke="#4a4a6a" stroke-width="8"/>
                        
                        <!-- Stator teeth with copper windings (dientes del estator con bobinas) -->
                        <g id="statorCoils"></g>
                        
                        <!-- Stator inner surface (superficie interior del estator) -->
                        <circle cx="200" cy="200" r="128" fill="none" stroke="#3a3a5a" stroke-width="2"/>
                        
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <!-- AIR GAP - Espacio de aire entre estator y rotor            -->
                        <!-- El campo magnético cruza esta zona                                        -->
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <circle cx="200" cy="200" r="126" fill="none" stroke="rgba(0, 255, 200, 0.3)" stroke-width="2" stroke-dasharray="4,4" class="air-gap"/>
                        
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <!-- ROTOR - Parte móvil con imanes internos (configuración IPM) -->
                        <!-- Similar a motores Tesla Model 3/Y                              -->
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <g class="rotor-group" id="rotorGroup">
                            
                            <!-- Rotor core - núcleo de acero laminado -->
                            <circle cx="200" cy="200" r="120" fill="url(#rotorGradient)" stroke="#00ffc8" stroke-width="3"/>
                            
                            <!-- Interior Permanent Magnets in V-shape configuration -->
                            <!-- Configuración de imanes en V - típica de Tesla -->
                            <g id="ipmMagnets"></g>
                            
                            <!-- Rotor slots for flux barriers (barreras de flujo) -->
                            <g id="fluxBarriers"></g>
                            
                            <!-- ═══════════════════════════════════════════════════════════ -->
                            <!-- SHAFT - Eje de transmisión                                          -->
                            <!-- Conecta el rotor a la transmisión del vehículo                -->
                            <!-- ═══════════════════════════════════════════════════════════ -->
                            <circle cx="200" cy="200" r="22" fill="url(#shaftGradient)" stroke="#5a5a6a" stroke-width="3"/>
                            <circle cx="200" cy="200" r="10" fill="#1a1a2a"/>
                            
                            <!-- Position marker for rotation visualization -->
                            <rect x="196" y="185" width="8" height="20" fill="#00ffc8" rx="2"/>
                        </g>
                        
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <!-- ELECTROMAGNETIC FIELD LINES - Líneas de campo magnético   -->
                        <!-- Solo visibles cuando el motor está encendido                       -->
                        <!-- ═══════════════════════════════════════════════════════════ -->
                        <g id="fieldLines"></g>
                        
                        <!-- Center RPM display -->
                        <text x="200" y="205" text-anchor="middle" dominant-baseline="middle" fill="#00ffc8" font-size="12" font-family="monospace" font-weight="bold" id="rpmText">OFF</text>
                    </svg>
                </div>
                
                <!-- Motor Specs -->
                <div class="motor-specs">
                    <div class="spec-item">
                        <span class="spec-label">Tipo:</span>
                        <span class="spec-value">IPM-SynRM</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-label">Potencia:</span>
                        <span class="spec-value">150 kW</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-label">Torque:</span>
                        <span class="spec-value">350 Nm</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-label">RPM máx:</span>
                        <span class="spec-value">18,000</span>
                    </div>
                </div>
                
                <!-- Component Legend -->
                <div class="component-legend">
                    <div class="legend-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        Leyenda de Componentes del Motor
                    </div>
                    <div class="legend-grid">
                        <div class="legend-item stator">
                            <div class="legend-color" style="background: linear-gradient(135deg, #3a3a5a, #2a2a4a);"></div>
                            <div class="legend-text">
                                <h5>Estator (Parte Fija)</h5>
                                <p>Estructura externa fija que contiene las bobinas de cobre. Genera el campo magnético rotativo.</p>
                            </div>
                        </div>
                        <div class="legend-item copper">
                            <div class="legend-color" style="background: linear-gradient(90deg, #b87333, #da8a47);"></div>
                            <div class="legend-text">
                                <h5>Bobinas de Cobre</h5>
                                <p>Devanados de wire de cobre aislado. La corriente eléctrica crea campos electromagnéticos.</p>
                            </div>
                        </div>
                        <div class="legend-item rotor">
                            <div class="legend-color" style="background: linear-gradient(135deg, #2a3a4a, #1a2a3a);"></div>
                            <div class="legend-text">
                                <h5>Rotor (Parte Móvil)</h5>
                                <p>Núcleo de acero laminado que gira. Contiene los imanes permanentes internos.</p>
                            </div>
                        </div>
                        <div class="legend-item magnet-n">
                            <div class="legend-color" style="background: linear-gradient(90deg, #cc3333, #ff4444);"></div>
                            <div class="legend-text">
                                <h5>Imán Norte (N)</h5>
                                <p>Imán permanente incrustado en el rotor. Polo norte orientado hacia el estator.</p>
                            </div>
                        </div>
                        <div class="legend-item magnet-s">
                            <div class="legend-color" style="background: linear-gradient(90deg, #3333cc, #4444ff);"></div>
                            <div class="legend-text">
                                <h5>Imán Sur (S)</h5>
                                <p>Imán permanente incrustado en el rotor. Polo sur orientado hacia el estator.</p>
                            </div>
                        </div>
                        <div class="legend-item airgap">
                            <div class="legend-color" style="background: #888;"></div>
                            <div class="legend-text">
                                <h5>Entrehierro (Air Gap)</h5>
                                <p>Espacio de aire entre estator y rotor. El campo magnético cruza esta zona.</p>
                            </div>
                        </div>
                        <div class="legend-item shaft">
                            <div class="legend-color" style="background: linear-gradient(135deg, #4a4a5a, #2a2a3a);"></div>
                            <div class="legend-text">
                                <h5>Eje (Shaft)</h5>
                                <p>Transmite la fuerza rotativa del motor a la transmisión del vehículo.</p>
                            </div>
                        </div>
                        <div class="legend-item field">
                            <div class="legend-color" style="background: rgba(0, 255, 200, 0.5);"></div>
                            <div class="legend-text">
                                <h5>Líneas de Campo</h5>
                                <p>Representación visual del flujo magnético entre estator y rotor.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tesla Tech Info -->
                <div class="tesla-specs">
                    <h4>
                        <span class="tesla-badge">TESLA</span>
                        Tecnología IPM-SynRM
                    </h4>
                    <div class="tesla-info">
                        <p>
                            Los motores Tesla utilizan una configuración <strong>IPM (Interior Permanent Magnet)</strong> 
                            combinada con <strong>Reluctancia Síncrona (SynRM)</strong>. Los imanes están incrustados 
                            dentro del rotor en forma de V, no en la superficie.
                        </p>
                        <p>
                            Esta configuración permite:<br>
                            • Mayor eficiencia en todo el rango de velocidad<br>
                            • Mejor enfriamiento de los imanes<br>
                            • Operación a altas RPM (hasta 20,000+)<br>
                            • Torque adicional por reluctancia
                        </p>
                    </div>
                    <div class="tesla-features">
                        <div class="tesla-feature">
                            <strong>Configuración</strong>
                            Imanes en V incrustados
                        </div>
                        <div class="tesla-feature">
                            <strong>Material</strong>
                            NdFeB (Neodimio)
                        </div>
                        <div class="tesla-feature">
                            <strong>Refrigeración</strong>
                            Aceite circulante
                        </div>
                        <div class="tesla-feature">
                            <strong>Eficiencia</strong>
                            Hasta 97%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="card">
                <!-- Voltage Control -->
                <div class="control-section">
                    <div class="control-header">
                        <div class="control-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                            </svg>
                            Voltaje del Bus DC
                        </div>
                        <div class="control-value" style="color: #eab308;" id="voltageValue">350V</div>
                    </div>
                    <input type="range" class="voltage-slider" id="voltageSlider" min="0" max="400" value="350">
                    <div class="slider-labels">
                        <span>0V</span>
                        <span>400V (Batería Tesla)</span>
                    </div>
                    <div class="control-comment">
                        <strong>Voltaje DC:</strong> Proviene del paquete de baterías. Tesla usa ~350-400V. 
                        Mayor voltaje = más potencia disponible pero mayor consumo.
                    </div>
                </div>

                <!-- Mode Selector -->
                <div class="control-section">
                    <div class="control-label" style="margin-bottom: 10px;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                        </svg>
                        Modo de Conducción
                    </div>
                    <div class="mode-selector">
                        <button class="mode-btn eco" data-mode="eco">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"></path>
                                <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"></path>
                            </svg>
                            <span>Eco</span>
                        </button>
                        <button class="mode-btn normal active" data-mode="normal">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path>
                                <circle cx="7" cy="17" r="2"></circle>
                                <path d="M9 17h6"></path>
                                <circle cx="17" cy="17" r="2"></circle>
                            </svg>
                            <span>Normal</span>
                        </button>
                        <button class="mode-btn sport" data-mode="sport">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                            </svg>
                            <span>Sport</span>
                        </button>
                    </div>
                    <div class="control-comment">
                        <strong>Modos:</strong> Eco limita potencia para máxima autonomía. 
                        Sport aumenta respuesta y potencia. Normal equilibra ambos.
                    </div>
                </div>

                <!-- Throttle -->
                <div class="control-section">
                    <div class="throttle-section">
                        <div class="throttle-container">
                            <div class="throttle-label">Pedal del Acelerador</div>
                            <div class="throttle-pedal" id="throttlePedal">
                                <div class="throttle-fill" id="throttleFill"></div>
                            </div>
                            <div class="throttle-value" id="throttleValue">0%</div>
                            <div class="throttle-buttons">
                                <button class="throttle-btn" id="throttleUp" disabled title="Aumentar +10%">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                </button>
                                <button class="throttle-btn" id="throttleDown" disabled title="Reducir -10%">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <button class="throttle-btn" id="throttleReset" disabled title="Soltar pedal">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="1 4 1 10 7 10"></polyline>
                                        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Battery & Temperature -->
                        <div class="status-gauges">
                            <div class="status-gauge">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="batteryIcon">
                                    <rect x="1" y="6" width="18" height="12" rx="2" ry="2"></rect>
                                    <line x1="23" y1="13" x2="23" y2="11"></line>
                                    <rect x="3" y="8" width="10" height="8" fill="currentColor" opacity="0.3"></rect>
                                </svg>
                                <div class="value battery-high" id="batteryValue">85%</div>
                                <div class="label">Batería</div>
                            </div>
                            <div class="status-gauge">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="tempIcon">
                                    <path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"></path>
                                    <line x1="12" y1="6" x2="12" y2="12" stroke-width="2"></line>
                                </svg>
                                <div class="value temp-normal" id="tempValue">35°C</div>
                                <div class="label">Temp. Motor</div>
                            </div>
                        </div>
                    </div>
                    <div class="control-comment">
                        <strong>Acelerador:</strong> Envía señal al inversor que controla la frecuencia 
                        y corriente hacia el motor. Suelta para regeneración de energía.
                    </div>
                </div>

                <!-- Current -->
                <div class="current-display">
                    <div class="current-label">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2" style="width: 16px; height: 16px;">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        Corriente CA (3 fases)
                    </div>
                    <div class="current-value" id="currentValue">0 A</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="currentFill" style="width: 0%"></div>
                </div>
                <div class="control-comment">
                    <strong>Corriente:</strong> El inversor convierte DC a CA trifásica. 
                    Mayor corriente = más torque, pero mayor calentamiento.
                </div>
            </div>

            <!-- Dashboard -->
            <div class="dashboard-section">
                <!-- Speed & RPM Gauges -->
                <div class="card">
                    <div class="gauge-row">
                        <div class="circular-gauge">
                            <svg viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="45"/>
                                <circle class="gauge-fill" cx="50" cy="50" r="45" id="speedGauge" 
                                    stroke-dasharray="282.7" stroke-dashoffset="282.7"/>
                            </svg>
                            <div class="gauge-inner">
                                <div class="gauge-value" id="speedValue">0</div>
                                <div class="gauge-unit">km/h</div>
                            </div>
                            <div class="gauge-label">Velocidad</div>
                        </div>
                        <div class="circular-gauge">
                            <svg viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="45"/>
                                <circle class="gauge-fill" cx="50" cy="50" r="45" id="rpmGauge"
                                    stroke-dasharray="282.7" stroke-dashoffset="282.7"/>
                            </svg>
                            <div class="gauge-inner">
                                <div class="gauge-value" id="rpmDisplay">0</div>
                                <div class="gauge-unit">RPM</div>
                            </div>
                            <div class="gauge-label">RPM Motor</div>
                        </div>
                    </div>
                    <div class="control-comment" style="margin-top: 10px;">
                        <strong>Velocidad:</strong> Calculada desde RPM × ratio transmisión (9:1 aprox). 
                        Tesla Model 3 alcanza 261 km/h máxima.
                    </div>
                </div>

                <!-- Power Gauge -->
                <div class="linear-gauge">
                    <div class="linear-gauge-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#00ffc8" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                        </svg>
                        <span class="linear-gauge-label">Potencia de Salida</span>
                    </div>
                    <div class="linear-gauge-value">
                        <span class="linear-gauge-number" style="color: #00ffc8;" id="powerValue">0</span>
                        <span class="linear-gauge-unit">kW</span>
                    </div>
                    <div class="linear-gauge-bar">
                        <div class="linear-gauge-fill cyan" id="powerFill" style="width: 0%"></div>
                    </div>
                    <div class="control-comment" style="margin-top: 8px; font-size: 0.7rem;">
                        P = V × I × Eficiencia. Model 3 Performance: hasta 353 kW (480 HP).
                    </div>
                </div>

                <!-- Torque Gauge -->
                <div class="linear-gauge">
                    <div class="linear-gauge-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        <span class="linear-gauge-label">Torque en el Eje</span>
                    </div>
                    <div class="linear-gauge-value">
                        <span class="linear-gauge-number" style="color: #f97316;" id="torqueValue">0</span>
                        <span class="linear-gauge-unit">Nm</span>
                    </div>
                    <div class="linear-gauge-bar">
                        <div class="linear-gauge-fill orange" id="torqueFill" style="width: 0%"></div>
                    </div>
                    <div class="control-comment" style="margin-top: 8px; font-size: 0.7rem;">
                        Torque = Fuerza rotativa. Los EV tienen torque máximo desde 0 RPM.
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#a855f7" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        <div class="stat-value" style="color: #a855f7;" id="consumptionValue">0</div>
                        <div class="stat-label">kWh/100km</div>
                    </div>
                    <div class="stat-card">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                        </svg>
                        <div class="stat-value" style="color: #22c55e;" id="rangeValue">6375</div>
                        <div class="stat-label">km autonomía</div>
                    </div>
                </div>
                <div class="control-comment" style="margin-top: 10px;">
                    <strong>Consumo:</strong> Model 3 Standard Range: ~14 kWh/100km. 
                    Long Range: hasta 600 km de autonomía.
                </div>
            </div>
        </div>

        <!-- Info Panel -->
        <div class="info-panel card" id="infoPanel">
            <div class="card-title">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                Información Técnica - Motor IPM tipo Tesla
            </div>
            <div class="info-content">
                <div class="info-section">
                    <h4>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        ¿Qué es un motor IPM?
                    </h4>
                    <p>
                        <strong>IPM (Interior Permanent Magnet)</strong> es un tipo de motor eléctrico donde 
                        los imanes permanentes están <strong>incrustados dentro del rotor</strong>, no en su superficie.
                        Esta configuración es utilizada por Tesla desde el Model 3.
                    </p>
                    <p>
                        La combinación con <strong>Reluctancia Síncrona (SynRM)</strong> permite obtener torque 
                        tanto de los imanes permanentes como de la variación de reluctancia magnética del rotor.
                    </p>
                </div>
                <div class="info-section">
                    <h4>Ventajas de la configuración IPM</h4>
                    <ul>
                        <li><strong>Mayor eficiencia:</strong> Hasta 97% en el punto óptimo de operación</li>
                        <li><strong>Mejor enfriamiento:</strong> Imanes protegidos dentro del rotor</li>
                        <li><strong>Altas RPM:</strong> Puede superar 20,000 RPM sin despegue de imanes</li>
                        <li><strong>Mayor densidad de potencia:</strong> Más potencia en menos espacio</li>
                        <li><strong>Torque adicional:</strong> Por efecto de reluctancia</li>
                        <li><strong>Wide constant power range:</strong> Potencia constante en amplio rango</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h4>Configuración de Imanes en V (Tesla)</h4>
                    <p>
                        Tesla utiliza una configuración de <strong> imanes en forma de V</strong> 
                        incrustados en el rotor. Esto optimiza el flujo magnético y permite:
                    </p>
                    <ul>
                        <li>Mejor distribución del campo magnético</li>
                        <li>Reducción de pérdidas por parpadeo (cogging torque)</li>
                        <li>Operación eficiente a altas velocidades</li>
                        <li>Mayor robustez mecánica del rotor</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h4>Fórmulas Físicas del Motor</h4>
                    <div class="formula-box">
                        <p><strong>Potencia:</strong> P = V × I × cos(φ) × Eficiencia</p>
                        <p><strong>Torque:</strong> T = k × I + T_reluctancia</p>
                        <p><strong>Velocidad:</strong> n = 120 × f / p (RPM)</p>
                        <p><strong>EMF:</strong> E = k × ω × φ (Fuerza contraelectromotriz)</p>
                        <p><strong>Eficiencia:</strong> η = P_salida / P_entrada</p>
                    </div>
                </div>
                <div class="info-section">
                    <h4>Comparación de Modos</h4>
                    <div class="mode-comparison">
                        <div class="mode-box eco">
                            <strong style="color: #22c55e;">ECO</strong>
                            <p style="color: #888;">-30% potencia<br>+15% eficiencia<br>Máxima autonomía</p>
                        </div>
                        <div class="mode-box normal">
                            <strong style="color: #3b82f6;">NORMAL</strong>
                            <p style="color: #888;">Potencia estándar<br>Eficiencia balanceada<br>Uso diario</p>
                        </div>
                        <div class="mode-box sport">
                            <strong style="color: #ef4444;">SPORT</strong>
                            <p style="color: #888;">+20% potencia<br>-15% eficiencia<br>Máximo rendimiento</p>
                        </div>
                    </div>
                </div>
                <div class="info-section">
                    <h4>Sistema de Propulsión Tesla</h4>
                    <p>
                        El sistema completo incluye:
                    </p>
                    <ul>
                        <li><strong>Batería:</strong> Paquete de iones de litio 350-400V, 75-100 kWh</li>
                        <li><strong>Inversor:</strong> Convierte DC a CA trifásica con IGBTs de alta potencia</li>
                        <li><strong>Motor:</strong> IPM-SynRM con refrigeración por aceite</li>
                        <li><strong>Transmisión:</strong> Reductora de 1 marcha, ratio ~9:1</li>
                        <li><strong>Diferencial:</strong> Distribuye potencia a las ruedas</li>
                    </ul>
                </div>
            </div>
        </div>

        <footer>
            <p>Simulador de Motor Eléctrico IPM tipo Tesla | Configuración con imanes permanentes interiores</p>
            <p style="margin-top: 5px; color: #333;">Los valores son simulados con fines educativos. Basado en tecnología Tesla Model 3/Y.</p>
        </footer>
    </div>

    <script>
        // Motor Constants (Tesla-style)
        const CONSTANTS = {
            maxVoltage: 400,
            maxRpm: 18000,
            maxCurrent: 600,
            transmissionRatio: 9.0,
            wheelDiameter: 0.68,
            efficiency: 0.96,
            batteryCapacity: 82, // kWh (Model 3 Long Range)
            maxTorquePerAmp: 0.7,
            baseTemperature: 35,
            maxTemperature: 150,
            polePairs: 4
        };

        const MODE_MULTIPLIERS = {
            eco: { power: 0.7, efficiency: 1.15 },
            normal: { power: 1.0, efficiency: 1.0 },
            sport: { power: 1.2, efficiency: 0.85 }
        };

        // State
        let state = {
            isOn: false,
            voltage: 350,
            currentRpm: 0,
            throttle: 0,
            mode: 'normal',
            batteryLevel: 85,
            temperature: CONSTANTS.baseTemperature
        };

        // DOM Elements
        const elements = {
            powerBtn: document.getElementById('powerBtn'),
            logoIcon: document.getElementById('logoIcon'),
            statusValue: document.getElementById('statusValue'),
            voltageSlider: document.getElementById('voltageSlider'),
            voltageValue: document.getElementById('voltageValue'),
            throttlePedal: document.getElementById('throttlePedal'),
            throttleFill: document.getElementById('throttleFill'),
            throttleValue: document.getElementById('throttleValue'),
            throttleUp: document.getElementById('throttleUp'),
            throttleDown: document.getElementById('throttleDown'),
            throttleReset: document.getElementById('throttleReset'),
            batteryValue: document.getElementById('batteryValue'),
            batteryIcon: document.getElementById('batteryIcon'),
            tempValue: document.getElementById('tempValue'),
            tempIcon: document.getElementById('tempIcon'),
            currentValue: document.getElementById('currentValue'),
            currentFill: document.getElementById('currentFill'),
            speedGauge: document.getElementById('speedGauge'),
            speedValue: document.getElementById('speedValue'),
            rpmGauge: document.getElementById('rpmGauge'),
            rpmDisplay: document.getElementById('rpmDisplay'),
            powerValue: document.getElementById('powerValue'),
            powerFill: document.getElementById('powerFill'),
            torqueValue: document.getElementById('torqueValue'),
            torqueFill: document.getElementById('torqueFill'),
            consumptionValue: document.getElementById('consumptionValue'),
            rangeValue: document.getElementById('rangeValue'),
            rotorGroup: document.getElementById('rotorGroup'),
            motorSvg: document.getElementById('motorSvg'),
            rpmText: document.getElementById('rpmText'),
            infoBtn: document.getElementById('infoBtn'),
            infoPanel: document.getElementById('infoPanel')
        };

        // Initialize SVG elements for Tesla-style IPM motor
        function initMotorSVG() {
            // Stator coils (12 slots, 3-phase)
            const statorCoils = document.getElementById('statorCoils');
            const numCoils = 12;
            for (let i = 0; i < numCoils; i++) {
                const angle = (i * 360 / numCoils);
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('transform', `rotate(${angle}, 200, 200)`);
                
                // Copper winding (tooth)
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', '192');
                rect.setAttribute('y', '25');
                rect.setAttribute('width', '16');
                rect.setAttribute('height', '55');
                rect.setAttribute('rx', '4');
                rect.setAttribute('fill', 'url(#copperGradient)');
                rect.setAttribute('stroke', '#8b4513');
                rect.setAttribute('stroke-width', '1');
                
                // Stator tooth
                const tooth = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                tooth.setAttribute('x', '196');
                tooth.setAttribute('y', '80');
                tooth.setAttribute('width', '8');
                tooth.setAttribute('height', '45');
                tooth.setAttribute('fill', '#3a3a5a');
                
                g.appendChild(rect);
                g.appendChild(tooth);
                statorCoils.appendChild(g);
            }

            // IPM Magnets in V-shape configuration (Tesla style)
            const ipmMagnets = document.getElementById('ipmMagnets');
            const numPoles = 8; // 4 pole pairs
            const vAngle = 35; // V-shape angle
            
            for (let i = 0; i < numPoles; i++) {
                const baseAngle = (i * 360 / numPoles);
                const isNorth = i % 2 === 0;
                
                // Two magnets per pole in V configuration
                for (let v = -1; v <= 1; v += 2) {
                    const magnetAngle = baseAngle + (v * vAngle / 2);
                    const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    g.setAttribute('transform', `rotate(${magnetAngle}, 200, 200)`);
                    
                    const magnet = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    magnet.setAttribute('x', '194');
                    magnet.setAttribute('y', '70');
                    magnet.setAttribute('width', '12');
                    magnet.setAttribute('height', '35');
                    magnet.setAttribute('rx', '2');
                    magnet.setAttribute('fill', isNorth ? 'url(#magnetNorth)' : 'url(#magnetSouth)');
                    magnet.setAttribute('opacity', '0.9');
                    
                    g.appendChild(magnet);
                    ipmMagnets.appendChild(g);
                }
            }

            // Flux barriers (air slots in rotor for reluctance torque)
            const fluxBarriers = document.getElementById('fluxBarriers');
            const numBarriers = 8;
            for (let i = 0; i < numBarriers; i++) {
                const angle = (i * 360 / numBarriers) + 22.5;
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('transform', `rotate(${angle}, 200, 200)`);
                
                // Barrier slot
                const barrier = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                barrier.setAttribute('x', '195');
                barrier.setAttribute('y', '110');
                barrier.setAttribute('width', '10');
                barrier.setAttribute('height', '15');
                barrier.setAttribute('rx', '2');
                barrier.setAttribute('fill', '#0a0a1a');
                barrier.setAttribute('opacity', '0.8');
                
                g.appendChild(barrier);
                fluxBarriers.appendChild(g);
            }

            // Field lines
            const fieldLines = document.getElementById('fieldLines');
            for (let i = 0; i < 12; i++) {
                const angle = (i * 30);
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                const x2 = 200 + 130 * Math.cos((angle * Math.PI) / 180);
                const y2 = 200 + 130 * Math.sin((angle * Math.PI) / 180);
                line.setAttribute('x1', '200');
                line.setAttribute('y1', '200');
                line.setAttribute('x2', x2);
                line.setAttribute('y2', y2);
                line.setAttribute('stroke', 'rgba(0, 255, 200, 0.35)');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('stroke-dasharray', '8,4');
                line.setAttribute('class', 'field-line');
                line.setAttribute('data-index', i);
                fieldLines.appendChild(line);
            }
        }

        // Calculate motor physics
        function calculatePhysics() {
            if (!state.isOn || state.throttle === 0) {
                return {
                    current: 0,
                    power: 0,
                    torque: 0,
                    speed: 0,
                    consumption: 0,
                    range: CONSTANTS.batteryCapacity * 100
                };
            }

            const modeConfig = MODE_MULTIPLIERS[state.mode];
            const effectiveVoltage = state.voltage * modeConfig.power;
            
            const current = (state.throttle / 100) * CONSTANTS.maxCurrent * (effectiveVoltage / CONSTANTS.maxVoltage);
            const power = (effectiveVoltage * current * CONSTANTS.efficiency) / 1000;
            const torque = current * CONSTANTS.maxTorquePerAmp * modeConfig.power * 1.3; // + reluctance torque
            
            const wheelRpm = state.currentRpm / CONSTANTS.transmissionRatio;
            const speed = (wheelRpm * Math.PI * CONSTANTS.wheelDiameter * 60) / 1000;
            
            const consumption = speed > 0 ? (power / speed) * 100 / modeConfig.efficiency : 0;
            const range = consumption > 0 ? (state.batteryLevel / 100 * CONSTANTS.batteryCapacity) / consumption * 100 : 0;

            return {
                current: Math.round(current * 10) / 10,
                power: Math.round(power * 10) / 10,
                torque: Math.round(torque * 10) / 10,
                speed: Math.round(speed * 10) / 10,
                consumption: Math.round(consumption * 100) / 100,
                range: Math.round(range)
            };
        }

        // Update UI
        function updateUI() {
            const calc = calculatePhysics();
            
            // Update voltage
            elements.voltageValue.textContent = `${state.voltage}V`;
            
            // Update throttle
            elements.throttleFill.style.height = `${state.throttle}%`;
            elements.throttleValue.textContent = `${Math.round(state.throttle)}%`;
            
            // Update battery
            elements.batteryValue.textContent = `${Math.round(state.batteryLevel)}%`;
            elements.batteryValue.className = 'value ' + 
                (state.batteryLevel < 20 ? 'battery-low' : state.batteryLevel < 50 ? 'battery-medium' : 'battery-high');
            elements.batteryIcon.style.stroke = 
                state.batteryLevel < 20 ? '#ef4444' : state.batteryLevel < 50 ? '#eab308' : '#22c55e';
            
            // Update temperature
            elements.tempValue.textContent = `${Math.round(state.temperature)}°C`;
            elements.tempValue.className = 'value ' + 
                (state.temperature > 100 ? 'temp-high' : state.temperature > 70 ? 'temp-medium' : 'temp-normal');
            elements.tempIcon.style.stroke = 
                state.temperature > 100 ? '#ef4444' : state.temperature > 70 ? '#f97316' : '#00ffc8';
            
            // Update current
            elements.currentValue.textContent = `${calc.current} A`;
            elements.currentFill.style.width = `${(calc.current / CONSTANTS.maxCurrent) * 100}%`;
            
            // Update speed gauge
            const speedPercent = Math.min((calc.speed / 280) * 100, 100);
            const circumference = 282.7;
            elements.speedGauge.style.strokeDashoffset = circumference - (speedPercent / 100) * circumference;
            elements.speedValue.textContent = Math.round(calc.speed);
            
            // Update RPM gauge
            const rpmPercent = Math.min((state.currentRpm / CONSTANTS.maxRpm) * 100, 100);
            elements.rpmGauge.style.strokeDashoffset = circumference - (rpmPercent / 100) * circumference;
            elements.rpmDisplay.textContent = Math.round(state.currentRpm);
            
            // Update power
            elements.powerValue.textContent = calc.power;
            elements.powerFill.style.width = `${Math.min((calc.power / 200) * 100, 100)}%`;
            
            // Update torque
            elements.torqueValue.textContent = calc.torque;
            elements.torqueFill.style.width = `${Math.min((calc.torque / 400) * 100, 100)}%`;
            
            // Update consumption and range
            elements.consumptionValue.textContent = calc.consumption;
            elements.rangeValue.textContent = calc.range;
            
            // Update motor visualization
            elements.rpmText.textContent = state.currentRpm > 0 ? `${Math.round(state.currentRpm)}` : 'OFF';
            
            // Update rotor animation
            if (state.isOn && state.currentRpm > 0) {
                const duration = 60 / state.currentRpm;
                elements.rotorGroup.style.setProperty('--spin-duration', `${duration}s`);
                elements.rotorGroup.classList.add('spinning');
            } else {
                elements.rotorGroup.classList.remove('spinning');
            }
            
            // Update field lines
            const fieldLines = document.querySelectorAll('.field-line');
            fieldLines.forEach((line, i) => {
                if (state.isOn && state.voltage > 0) {
                    line.classList.add('active');
                    line.style.animationDelay = `${i * 0.08}s`;
                } else {
                    line.classList.remove('active');
                }
            });
            
            // Update motor SVG glow
            if (state.isOn) {
                elements.motorSvg.classList.add('active');
                elements.motorSvg.style.filter = `drop-shadow(0 0 ${state.voltage / 25}px rgba(0, 255, 200, 0.25))`;
            } else {
                elements.motorSvg.classList.remove('active');
                elements.motorSvg.style.filter = 'none';
            }
        }

        // Animation loops
        let rpmInterval, tempInterval, batteryInterval;

        function startAnimationLoops() {
            // RPM transition
            rpmInterval = setInterval(() => {
                if (!state.isOn) {
                    state.currentRpm = Math.max(0, state.currentRpm - 150);
                } else {
                    const targetRpm = (state.throttle / 100) * CONSTANTS.maxRpm * (state.voltage / CONSTANTS.maxVoltage);
                    const diff = targetRpm - state.currentRpm;
                    state.currentRpm = Math.max(0, state.currentRpm + diff * 0.08);
                }
                updateUI();
            }, 16);

            // Temperature
            tempInterval = setInterval(() => {
                if (!state.isOn) {
                    state.temperature = Math.max(CONSTANTS.baseTemperature, state.temperature - 0.8);
                } else {
                    const calc = calculatePhysics();
                    const heatGeneration = (state.currentRpm / CONSTANTS.maxRpm) * 8 + (calc.power / 150) * 15;
                    const heatDissipation = 3;
                    state.temperature = Math.min(CONSTANTS.maxTemperature, 
                        Math.max(CONSTANTS.baseTemperature, state.temperature + heatGeneration - heatDissipation));
                }
                updateUI();
            }, 1000);

            // Battery
            batteryInterval = setInterval(() => {
                if (state.isOn) {
                    const calc = calculatePhysics();
                    if (calc.power > 0) {
                        const drain = (calc.power / CONSTANTS.batteryCapacity) * 0.08;
                        state.batteryLevel = Math.max(0, state.batteryLevel - drain);
                    }
                }
                updateUI();
            }, 1000);
        }

        // Event Handlers
        function handlePowerToggle() {
            state.isOn = !state.isOn;
            
            if (state.isOn) {
                elements.powerBtn.classList.add('active');
                elements.logoIcon.classList.add('active');
                elements.statusValue.classList.remove('off');
                elements.statusValue.classList.add('on');
                elements.statusValue.textContent = 'ENCENDIDO';
                elements.throttleUp.disabled = false;
                elements.throttleDown.disabled = false;
                elements.throttleReset.disabled = false;
            } else {
                state.throttle = 0;
                elements.powerBtn.classList.remove('active');
                elements.logoIcon.classList.remove('active');
                elements.statusValue.classList.remove('on');
                elements.statusValue.classList.add('off');
                elements.statusValue.textContent = 'APAGADO';
                elements.throttleUp.disabled = true;
                elements.throttleDown.disabled = true;
                elements.throttleReset.disabled = true;
            }
            
            updateUI();
        }

        function handleVoltageChange(e) {
            state.voltage = parseInt(e.target.value);
            updateUI();
        }

        function handleModeChange(mode) {
            state.mode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.mode-btn.${mode}`).classList.add('active');
            updateUI();
        }

        function handleThrottleChange(value) {
            if (!state.isOn) return;
            state.throttle = Math.max(0, Math.min(100, value));
            updateUI();
        }

        // Throttle pedal interaction
        let isThrottlePressed = false;

        function initThrottlePedal() {
            const pedal = elements.throttlePedal;
            
            pedal.addEventListener('mousedown', (e) => {
                if (!state.isOn) return;
                isThrottlePressed = true;
            });
            
            document.addEventListener('mouseup', () => {
                if (isThrottlePressed) {
                    isThrottlePressed = false;
                    handleThrottleChange(0);
                }
            });
            
            pedal.addEventListener('mousemove', (e) => {
                if (!isThrottlePressed || !state.isOn) return;
                const rect = pedal.getBoundingClientRect();
                const y = e.clientY - rect.top;
                const newValue = Math.max(0, Math.min(100, 100 - (y / rect.height) * 100));
                handleThrottleChange(newValue);
            });

            // Touch support
            pedal.addEventListener('touchstart', (e) => {
                if (!state.isOn) return;
                isThrottlePressed = true;
            });
            
            document.addEventListener('touchend', () => {
                if (isThrottlePressed) {
                    isThrottlePressed = false;
                    handleThrottleChange(0);
                }
            });
            
            pedal.addEventListener('touchmove', (e) => {
                if (!isThrottlePressed || !state.isOn) return;
                const rect = pedal.getBoundingClientRect();
                const touch = e.touches[0];
                const y = touch.clientY - rect.top;
                const newValue = Math.max(0, Math.min(100, 100 - (y / rect.height) * 100));
                handleThrottleChange(newValue);
            });
        }

        // Initialize
        function init() {
            initMotorSVG();
            initThrottlePedal();
            startAnimationLoops();
            
            // Event listeners
            elements.powerBtn.addEventListener('click', handlePowerToggle);
            elements.voltageSlider.addEventListener('input', handleVoltageChange);
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', () => handleModeChange(btn.dataset.mode));
            });
            
            elements.throttleUp.addEventListener('click', () => handleThrottleChange(state.throttle + 10));
            elements.throttleDown.addEventListener('click', () => handleThrottleChange(state.throttle - 10));
            elements.throttleReset.addEventListener('click', () => handleThrottleChange(0));
            
            elements.infoBtn.addEventListener('click', () => {
                elements.infoPanel.classList.toggle('visible');
            });
            
            updateUI();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
